"use strict";newMessage=function(){var e="/message?ajax=true",t=new XMLHttpRequest,n=document.getElementById("message-input"),s=n.value;if(s){n.value="",n.focus();var a="message="+encodeURIComponent(s);return t.open("POST",e),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(a),!1}},checkIsNewMessage=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){console.log("waiting for a new message");var e="/is-new-message?"+Math.random(),t=new XMLHttpRequest;t.open("GET",e),t.onload=function(){console.log("Got new message!"),getMessages(),checkIsNewMessage()},t.onreadystatechange=function(){4===t.readyState&&(200===t.status||setTimeout(function(){checkIsNewMessage()},500))},t.send()}),getMessages=function(){var e="/messages.json",t=new XMLHttpRequest;t.open("GET",e),t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status){var e=JSON.parse(t.responseText),n=e.msgs,s=e.people;document.getElementById("im-list").innerHTML=s.join("");for(var a="",o=0;o<n.length;o++)a+=n[o];document.getElementById("day_msgs").innerHTML=a;for(var r=document.getElementsByClassName("timestamp"),o=0;o<r.length;o++){var g=new Date(Number(r[o].getAttribute("data-ts"))),u=g.getHours(),c=u>12?"PM":"AM",u=u>12?u-12:u;r[o].innerHTML=u+":"+g.getMinutes()+" "+c}var i=document.getElementById("messages_container");i.scrollTop=i.scrollHeight}else console.log("Error: "+t.status)},t.send()},window.onload=function(){getMessages(),checkIsNewMessage()};